version: '{build}'
init:
- cmd: >-
    npm update -g
    
    npm install -g cordova

install:
- ps: >-
    $secureString = convertto-securestring "GrEC`$2015" -asplaintext -force
    
    $secureString2 = convertto-securestring "GrECo2017" -asplaintext -force
    
    Import-PfxCertificate -FilePath C:\projects\windowsapp\certification\certificate\GrECo.pfx -CertStoreLocation Cert:\CurrentUser\My -Password $secureString
    
    Import-PfxCertificate -FilePath C:\projects\windowsapp\certification\certificate\GrECo-winstore.pfx -CertStoreLocation Cert:\CurrentUser\My -Password $secureString2

build_script:
- cmd: >-
    cd src
    
    cordova platform add windows
    
    cordova platform ls
    
    cordova build --release windows --appx=uap --archs=arm
    
before_deploy:

- cmd: 7z a AppPackages.zip C:\projects\windowsapp\src\platforms\windows\AppPackages\

deploy:
- provider: GitHub
  auth_token:
    secure: 17ac4d57fc3edbfa41830f8d5db354cf86788915
  artifact: C:\projects\windowsapp\src\AppPackages.zip